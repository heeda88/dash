# 도커구동메뉴얼

![image-20211228100716878](/home/heeda-namu/snap/typora/46/.config/Typora/typora-user-images/image-20211228100716878.png)

### 도커  아카이빙 파일 임포트

```bash
# audiodata.tar 파일  ->  audiogram:1.0 도커이미지 생성
# 용량관계상(17GB) 약 5분 정도의 시간이 소요됨 
```

```bash
docker import audiodata.tar audiogram:1.0
```



### 도커 이미지 리빌드

```bash
# entrypoint 설정을 위함
# 아래와 같이 포함된 dockerfile 로 리빌딩
```

```bash
FROM audiogram:1.0
# ENTRYPOINT
ENV audioport=9090
ENTRYPOINT su - namu -c "conda run -n namu jupyter lab --ip=0.0.0.0 --port=$audioport --allow-root --no-browser --NotebookApp.token=''"
```

```bash
docker build -f dockerfile -t audiogram:1.0 .
```



### 도커 이미지 빌드 진행도 확인 

### ![image-20211228103306500](/home/heeda-namu/snap/typora/46/.config/Typora/typora-user-images/image-20211228103306500.png)



### 컨테이너 실행

```bash
# 데몬프로세스로(-d) 로컬호스트 9090 포트에 : 컨테이너 9090포트에 연결함(-p 9090:9090)
```

```bash
docker run --name TTA -dp 9090:9090 audiogram:1.0 
```



### 주피터랩  - 테스팅 

```bash
http://0.0.0.0:9090 
```

```bash
#위의 링크로 접속시 아래와 같은 화면을 볼 수 있음
```

![image-20211228103848503](/home/heeda-namu/snap/typora/46/.config/Typora/typora-user-images/image-20211228103848503.png)

```bash
# Terminal 1 탭에서 
```

```bash
# 가상 환경 활성화
conda activate namu
```

```bash
# 디렉토리 이동
cd ~/workproject
```

```bash
# 기존에 학습된 모델로 테스트 실행  > test.log 에 저장됨 
bash test.sh
```



![image-20211228104847989](/home/heeda-namu/snap/typora/46/.config/Typora/typora-user-images/image-20211228104847989.png)

```bash
# 테스트 수행 로그 불러오기
cat test.log
```

```bash
# 재학습시 기존 모델은 덮어쓰기 되므로 주의   
python train.py
```

